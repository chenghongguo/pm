
初始组件需求：
zk版本
zookeeper-3.4.6  以上
rabbitmq-3.1.5
jdk 8

1：本版本为单机内存运行，不需要任何数据库及其它存储以及缓存，错了，需要配置一个FTP的目录保存组件包。
2：修改conf.properties文件中的 FTP目录（保存组件包用，这个是必须的）
3：conf.properties文件，本版本没有用到zookeeper开头的配置，可以不用管
4：conf.properties文件，用户的登陆名是在本文件配置的，如果需要修改，只需要修改：admin.username属性即可，
	密码是md5值，默认密码是：admin,MD5值不区分大小写，如果需要修改只需要把密码的MD5值放在：admin.password 属性
5：如果传递消息时需要用到rabbit，需要把 rabbit_addr的值修改正确
6：thread_pool_max_size 是线程池的大小，一般不用改
7：self_group=pm  这个属性也没有多少用



1：两个测试的组件包，
	word_count-v1.0.jar ：统计收到的字符串的数量，按属性配置收到多少次打印一次日志
	word_create-v1.0.jar：随机发送 com、guttv字符串，按配置发送够次数后，就不再发送
2：使用时，先进入系统，从  组件-->组件包列表 分别选择两个测试组件进行注册。（一定要配置FTP目录）
3：从 流程-->流程制作 页面画出流程，保存。
4：在 流程--> 流程列表 点击“执行配置”按钮，生成可执行的流程。
5：在执行列表页面，进入“查看”，修改属性值，以及通道名称
6：在执行列表页面，启动，查看日志 



2017-12-04
再有持久化到zookeeper上的版本

1：修改了上个版本发现的BUG；
2：添加了部分功能，
		1、在执行配置列表页面，添加“重生”功能，可以把流程重新生成，如果节点不变，属性会保留。线节点可以换，只要两个端的节点ID和组件类型不变，通道属性会保留。
		2、在执行配置列表页面，添加“还原”功能，如果流程已经被删除，可以把执行配置上的流程还原到流程列表
		3、把早期几个枚举类型使用Integer的属性改成使用枚举值本身
		4、在执行列表页面的“查看”页面，添加配置属性的统一修改页面，方便修改组件属性。
3：把组件包、组件、流程、流程执行配置信息全部持久化到zookeeper，启动时加载所有配置，并启动执行中的流程执行配置。
4：编写ComponentClassLoader类重写URLClassLoader的loadClass方法，修改类的加载顺序：改为先从组件包中加载类，再从系统Loader中加载。
5：注册组件包的顺序改为：先注册；再上传组件包；再持久化到zookeeper，如果有失败的，再卸载。
6：实现了列表页面的 搜索、排序
7：去掉了列表页面的 总页数显示和列表下面的翻页显示  此版本完全是一页面显示



1：添加errorQueue和alarmQueue通道配置，发送错误数据反馈，和系统告警
2：流程执行配置 查看页面添加 历史状态描述信息功能
3：卸载时，把FTP上的jar(zip)删除。
4：编辑流程时，节点的属性以全部属性为准，不再以保存的属性为准，（当组件增减属性时，会有效果）
5：代理类实现closeable接口时，组件执行结束，调用close方法
6：数据处理异常不再调用rollback方法，而是把错误数据发到异常队列里 防止错误数据影响处理流程
7：解决BUG
	a.组件包注册页面，不先文件，先点“注册”按钮，弹出“请选文件”框之后，“注册”按钮不可用
8：在首页显示组件及流程执行情况



2017-12-13
1：修改了rabbitmq的生产消费失败方式
2：修改了ConsumerFactory ProducerFactory两个类的路径，由task包移动到msg包



2017-12-15
添加了RPC框架，分别用netty和zookeeper两种方式实现

2017-12-18
在组件中添加 初始化方法 和  关闭方法两个字段，并修改相关实现
把init方法由 AbstractRecycleTask 提到AbstractTask类中调用，不管是不是周期的组件，都可以实现此方法



2017-12-20
添加统一从zookeeper上获取ID的方法
元数据对象的ID使用从zookeeper上获取的递增序号
列表页面默认改为按ID排序，不再默认按更新时间排序




2017-12-26
修改list Action中方法，都用绝对路径，支持配置servletContextPath使用，还有 login.jsp,index.jsp
修改 conponent,flow,flowexeconfig，改为监听zookeeper，从zookeeper上更新缓存信息



================================================================================================
上面是单机版
================================================================================================




================================================================================================
下面支持分布式，平台支持多机
================================================================================================

2018-01-04
1.异常控制流程       完成
2.注解指定组件类    完成
3.组件添加组的概念   完成
4.简化执行容器
5.插件管理  jre
6.脚本管理  安装jre、处理环境变量等、三方jar  
7.容器版本管理
8.执行流程时，直接把值赋给属性，不再经过set方法    完成
9.流程制作页面支持组  完成
10.节点暂停，继续，获取任务堆栈  完成
11.单机支持，添加配置  完成
12.确认rabbit消息有没有改造完 完成
13.RPC request,response添加IP地址 完成
14.平台配置文件可以动态刷新  完成
15.容器配置文件可以查看，并动态刷新  完成
16.容器心跳超时发送邮件    完成
17.支持定时执行任务   完成
18.流程制作页面不要有缓存（回写URL） 完成
 autocomplete='off'

遗留问题：
自动部署
权限管理


2018-01-09
支持quartz调度任务 完成

替换groovy的版本：由2.6.0-alpha-1 更改为 2.4.12

2018-01-10
修改了主机是否可达的判断方法
CheckPortUtil.isReachable
添加Pinger类

2018-01-17
支持rest类型的接口，实现http请求的数据，可以通过框架的通道发送出来
把从注解注册和配置文件注册拆分成两个实现类
LoginFilter添加启动顺序
问题：
Name for argument type [java.lang.String] not available, and parameter name information not found in class file either.
原因：系统没有找到参数的名称
解决方案：
1、在参数上添加注解：@RequestParam(value = "name")，一定要显示定义value="name"。
2、或者把参数包装成复杂对象。
3、或者在类中定义一个同名变量


支持rest接口发布测试：
1、测试从request中获取参数 通过
2、重写异常信息反馈句柄  不必重写
3、测试参数传入对象中 通过
4、测试抛异常  通过
5、测试返回json  通过，非简单对象
6、数据发送到队列 通过 必须使用注释方式在需要写出数据的方法主注解@Writeable，目前还不能通过配置XML文件方式实现
7、修改验证路径方法 完成
8、测试斜杠结尾路径 完成，不能访问
9、测试post get方法  完成，均可获取数据
10、测试一个方法多个访问路径 //通过，均可访问
11、测试配置文件注册  通过
12、测试直接发送简单对象参数   eclipse下运行正常，发布服务器取不到参数，在方法的参数前添加@RequestParam(value = "name")即可，一定要显示定义value="name"。



2018-01-20
注册完成后，根据设置是否要缓存classloader卸载classloader缓存，主要根据是否需要在系统运行，
如果是容器器是需要缓存的，如果是平台，需要根据平台配置的是否是单独运行和是否启动容器而定

添加扫描述spring配置功能
如果组件包里有 *-comID-spring.xml 命名的配置文件，系统会自动加载


2018-01-25
添加入库组件的支持  需要添加额外的JAR
执行容器不需要加载和监听组件信息
流程配置在容器中执行的时候再下载组件包，在ComponentNodeBean类里添加comID字段方便执行时查找需要下载哪些组件包
平台侧启动时去掉从zookeeper上加载组件包、组件、流程和流程执行配置（全部由监听处理）

页面添加分页


2018-02-11
上传到FTP上组件包，用MD5值命名，防止包重名覆盖


2018-03-10
添加抄送队列
添加自动部署
添加权限管理